const addContent=(e,t)=>{let n=`${e} ${t} .blank`;$(t,n).off(),$(`${e} ${t} section`).length||$(n).removeClass("hidden").addClass("flex"),$(n).click((function(){$(n).removeClass("flex").addClass("hidden"),$(`${e} ${t} .addContent`).css("display","").addClass("flex"),$(`${e} ${t} .addContent`).ready((()=>{handleOptionSelection(e,t)}))}))},checkRSSstatus=e=>{e?($(".toggleRss__Input").prop("checked",!0),$(".toggleRss__Slider").removeClass("unchecked"),addContent(".content1__container",".content1"),addContent(".content2__container",".content2"),addContent(".content3__container",".content3")):(hideLoading(),$(".toggleRss__Input").prop("checked",!1),$(".contentContainers").fadeOut().toggleClass("hidden flex").removeAttr("style"))},getMousePosition=()=>{$(window).mousemove((e=>{mousePosition.x=e.pageX,mousePosition.y=e.pageY}))},hideContent=e=>{$(e).click((()=>{".audio__remove"===e?(document.getElementById("audio__player").pause(),$(".audio").hide()):".converter__body__remove"===e&&$(".converter").fadeOut()})),$(".contentContainers").css("marginTop","")},hideLoading=()=>{setTimeout((()=>{$(".loading").fadeOut((function(){$(this).removeClass("flex").addClass("hidden").removeAttr("style")}))}),3e3)},addRemovalBtn=e=>{const t=()=>$(".confirmation__child__content section").remove();$("<img>").addClass("removeContentBtn").attr({alt:"Remove content",src:"./client/scss/icons/interface/cross.svg"}).appendTo(e).click((function(){let e=`.${$(this).parents(".content__container").attr("id")} .${$(this).parents(".content").attr("id")}`;$(".confirmation").fadeIn().css("display","flex"),$(".mainContainer").addClass("blur"),$(e).clone().appendTo(".confirmation__child__content"),disableScroll(),$(".confirmation__child__btnContainer__saveBtn").click((function(){restoreScroll(),$(".mainContainer").removeClass("blur"),$(`${e} .blank`).css("display",""),addContent(e),t(),$(".confirmation").fadeOut(),socket.emit("remove content",{parent:e.split(" ")[0],element:e.split(" ")[1]}),$(e).remove(),$(`${e} .blank`).removeClass("hidden")})),$(".confirmation__child__btnContainer__cancelBtn, .click").click((()=>{restoreScroll(),t(),$(".mainContainer").removeClass("blur"),$(".confirmation").fadeOut()}))}))},parseContent=()=>{socket.on("parse content",(e=>{console.log("parse content !",e);for(const[t,n]of e.entries()){const e=(e,t,n,s)=>{if($(t).length)s();else{let o=$("<div></div>").addClass(`content content${n}`).attr("id",`content${n}`);$(t).length||o.appendTo(e),$(t).ready((()=>{$(`${t} .blank`).length||$(`${t} .addContent`).length||$(t).prepend(i).append(l),s()}))}};let t=n.parent,s=n.element,o=`${n.parent} ${n.element}`,a=Number(s.match(/[0-9]{1,}/)),i=$(".blank").clone()[0],l=$(".addContent").clone()[0];e(t,o,a,(()=>{if($(o).off(),"weather"===n.type&&($(`${o} .forecast`).length||void 0!==n.location&&owmToken.match(/[a-z0-9]{32}/)&&$.ajax({url:`https://api.openweathermap.org/data/2.5/find?q=${n.location}&units=metric&lang=en&appid=${owmToken}`,method:"POST",dataType:"json",statusCode:{401:()=>{printError({type:"weather",msg:"Sorry dude, your OpenWeatherMap token is invalid 😢. Please modify it in the settings.",element:o})},200:e=>{e.cod;0!==e.count?addWeatherContainer(e,o):printError({type:"weather",msg:"Sorry homie, it seems this location doesn't exist...",element:o})}}})),"rss"===n.type){let e=n.feed;$(`${o} .rssContainer`).length||buildRssContainer(e,o,n.url,((e,t)=>{console.log("RSS container is built"),t.appendTo(o),displayArticleSummary()}))}if("youtube search"===n.type){if(!$(".youtubeSearchContainer").length){$("<section></section>").addClass("youtubeSearchContainer").appendTo(o);let e=$("<p></p>").text("Instant Youtube search"),t=$("<div></div>").addClass("youtubeSearchContainer__header flex").appendTo(`${o} .youtubeSearchContainer`).append(e),n=$("<input>").addClass("youtubeSearchContainer__content__input input").attr("placeholder","Type here to search Youtube..."),s=$("<div></div>").addClass("youtubeSearchContainer__content__results flex"),a=($("<div></div>").addClass("youtubeSearchContainer__content flex").append(n,s).appendTo(`${o} .youtubeSearchContainer`),$("<span></span>").addClass("contentOptions").appendTo(t));$("<img>").addClass("contentOptions__clearResultsbtn").attr({alt:"Clear search results",src:"./client/scss/icons/interface/clear.svg"}).appendTo(a);addRemovalBtn(a),addContentOptions(o)}$(".youtubeSearchContainer").keypress((e=>{if(13===e.keyCode){$(".youtubeSearchContainer__content__results").addClass("hidden");const e=(e,t)=>{for(let n=0;n<e.length;n++){let s="",o="",a="",i="",l="";const r=()=>{let t=e[n].lengthSeconds,s=Math.floor(t/60),o=t%60,a=Math.floor(t/3600),i="";return 0!==a&&(i+=`${a}:`),0!==s&&s<60&&(i+=`${s}:`),0!==o&&o<60&&(i+=`${o}`),i},d=()=>{let t=$("<span></span>").addClass(`youtubeSearchContainer__content__results__result youtube__result${n} flex`).append(i).appendTo(".youtubeSearchContainer__content__results"),s=$("<div></div>").addClass("youtubeSearchContainer__content__results__result__thumbnailContainer flex").prependTo(t);"channel"!==e[n].type&&"playlist"!==e[n].type?l=$("<img>").attr("alt",`${e[n].title} thumbnail`).attr("src",e[n].videoThumbnails[1].url).prependTo(s):"channel"===e[n].type?l=$("<img>").attr("alt",`${e[n].author} channel thumbnail`).attr("src",e[n].authorThumbnails[0].url).prependTo(s):"playlist"===e[n].type&&(l=$("<img>").attr("alt",`${e[n].title} thumbnail`).attr("src",e[n].playlistThumbnail).prependTo(s))};"video"===e[n].type?(s=$("<a></a>").attr("href",`${t}/watch?v=${e[n].videoId}`).text(e[n].title),o=$("<p></p>").text(e[n].videoId).prepend("<u>Video ID</u> : "),a=$("<p></p>").text(r()).prepend("<u>Duration</u> : ")):"channel"===e[n].type?(s=$("<a></a>").attr("href",`${t}${e[n].authorUrl}`).text(e[n].author),a=$("<p></p>").text(e[n].videoCount).prepend("<u>Number of videos</u> : "),o=$("<p></p>").text(e[n].authorId).prepend("<u>Channel ID</u> : ")):"playlist"===e[n].type&&(s=$("<a></a>").attr("href",`${t}/playlist?list=${e[n].playlistId}`).text(e[n].title),o=$("<p></p>").text(`${e[n].playlistId}`).prepend("<u>Playlist ID</u> : "),a=$("<p></p>").text(e[n].videoCount).prepend("<u>Number of videos</u> : ")),i=""!==o?$("<span></span>").addClass("youtubeSearchContainer__content__results__result__content flex").append(s,a,o):$("<span></span>").addClass("youtubeSearchContainer__content__results__result__content flex").append(s,a),$(`.youtube__result${n}`).length?$(".youtubeSearchContainer__content__results").length&&($(".youtubeSearchContainer__content__results").empty(),d()):d(),1===n&&$(".youtubeSearchContainer__content__results").removeClass("hidden").css("visibility","visible")}},t=(n,s)=>{console.log(s),$.ajax({url:`${s}/api/v1/search?q=${$(".youtubeSearchContainer__content__input").val()}&language=json&type=all`,method:"GET",dataType:"json"}).done((o=>{0===o.length?0===o.length&&n<invidiousInstances.length?t(n,invidiousInstances[n+1]):(printError({type:"generic",msg:"Sorry, the audio stream failed to load due to a server error... Try maybe later."}),n=0):e(o,s)})).fail((e=>{n<invidiousInstances.length?t(n,invidiousInstances[n+1]):(printError({type:"generic",msg:"Sorry, the audio stream failed to load due to a server error... Try maybe later."}),n=0)}))};t(0,invidiousInstances)}}))}setTimeout((()=>{$(`${t} .newContent`).length||$("<div></div>").addClass("newContent content subRow flex").appendTo(t).prepend(i).append(l),"absolute"===$("footer").css("position")&&$(".footer").css({position:"",top:""});let e=$(`${t} .newContent .blank`);$(e).click((function(){$(this).addClass("hidden").removeClass("flex"),$(`${t} .newContent .addContent`).css("display","").addClass("flex"),$(`${t} .newContent .addContent`).ready((()=>{handleOptionSelection(t,".newContent")}))})),$(".newContent").ready((()=>{$(".newContent .blank").removeClass("hidden"),$(".content").each((function(e){$(this).hasClass("newContent")?$(this).css("order",100):$(this).css("order",$(this).attr("id").substring(7,9))}))}))}),500),t.match(a)||$(o).addClass("subRow"),$(`${o} .blank`).removeClass("flex").addClass("hidden")}))}})),hideLoading()},showAbout=()=>{$(".aboutLink").click((function(){disableScroll(),$(".backgroundImage, header, .mainContainer").toggleClass("blur"),$(".about__container").fadeIn().toggleClass("hidden flex").removeAttr("style")})),$(".updateBtn").click((function(){socket.emit("update check")})),socket.on("update progress",(e=>{$(".updateBtn").text(e)})),$(".about__container").click((function(e){e.target===this&&$(this).fadeOut((function(){$(this).toggleClass("hidden flex").removeAttr("style"),$(".mainContainer, .header, .backgroundImage").removeClass("blur"),restoreScroll()}))}))},showConverter=()=>{let e;$(".unitsLink").on("click",(function(){$(".converter").fadeIn().css("display","flex")})),$(".converter__body__input, .converter__body__value1, .converter__body__value2").on("change",(()=>{let t=$(".converter__body__value1").val(),n=Number($(".converter__body__input").val()),s=$(".converter__body__value2").val();isNaN(n)?printError({type:"unit conversion",element:$(".converter"),msg:"Please enter a numeric value... 😑"}):("Byte"===t?"Kilobyte"===s?e=n/Math.pow(1024,1):"Megabyte"===s?e=n/Math.pow(1024,2):"Gigabyte"===s?e=n/Math.pow(1024,3):"Terabyte"===s?e=n/Math.pow(1024,4):"Byte"===s&&(e=n):"Kilobyte"===t?"Byte"===s?e=n*Math.pow(10,6):"Megabyte"===s?e=n/Math.pow(10,3):"Gigabyte"===s?e=n/Math.pow(10,6):"Terabyte"===s?e=n/Math.pow(10,9):"Kilobyte"===s&&(e=n):"Megabyte"===t?"Kilobyte"===s?e=n*Math.pow(10,3):"Byte"===s?e=n*Math.pow(10,6):"Gigabyte"===s?e=n/Math.pow(10,3):"Terabyte"===s?e=n/Math.pow(10,6):"Megabyte"===s&&(e=n):"Gigabyte"===t?"Kilobyte"===s?e=n*Math.pow(10,6):"Byte"===s?e=n*Math.pow(10,9):"Megabyte"===s?e=n*Math.pow(10,3):"Terabyte"===s?e=n/Math.pow(10,3):"Gigabyte"===s&&(e=n):"Terabyte"===t&&("Kilobyte"===s?e=n*Math.pow(10,9):"Byte"===s?e=n*Math.pow(10,12):"Megabyte"===s?e=n*Math.pow(10,6):"Gigabyte"===s?e=n*Math.pow(10,3):"Terabyte"===s&&(e=n)),$(".converter .warning").hide(),""!==n&&(e=>{void 0!==e?$(".converter__body__result").val(e):($(".converter__body__result").val(""),console.log(`Error converting unit... Result value : ${e}`))})(e))})),hideContent(".converter__body__remove")},showSettings=()=>{let e,t;const n=(n,s,o)=>{const a=document.querySelector(n).files[0];if(!a)return console.error("Compression failed because there is no file !");{const i=new FileReader;i.readAsDataURL(a),i.onload=a=>{const i=document.createElement("img");i.src=a.target.result,i.onload=a=>{const i=window.innerWidth,l=document.createElement("canvas");l.height=a.target.height*(i/a.target.width),l.width=i;const r=l.getContext("2d");r.drawImage(a.target,0,0,l.width,l.height),".backgroundImageUploadForm__InputFile"===n?(t=r.canvas.toDataURL(s,.8),o(t)):(e=r.canvas.toDataURL(s,.8),o(e))}}}},s=()=>{$(".uploadWarning").length&&$(".uploadWarning").remove(),restoreScroll(),$(".backgroundImage, header, .mainContainer").removeClass("blur"),$(".settings__container").fadeOut()};let o={},a=!1;$(".toggleRss__Input").prop("checked")?$(".toggleRss__Slider").removeClass("unchecked"):$(".toggleRss__Slider").addClass("unchecked"),$(".settingsLink").click((()=>{$(".backgroundImage, header, .mainContainer").addClass("blur"),disableScroll(),$(".settings__container").fadeIn().css("display","flex")})),$(".backgroundImageUploadForm__Btn").click((()=>{$(".backgroundImageUploadForm__InputFile").click()})),$(".chatCustomizationForm__btn").click((()=>{$(".chatCustomizationForm__inputFile").click()})),$(".toggleRss__Switch").click((()=>{o.RSS=$(".toggleRss__Input").prop("checked"),$(".toggleRss__Input").prop("checked")?($(".toggleRss__Slider").removeClass("unchecked"),$(".contentContainers").hasClass("hidden")&&$(".contentContainers").fadeIn().toggleClass("hidden flex").removeAttr("style"),$(".footer").hasClass("fixed")&&$(".footer").toggleClass("fixed")):($(".toggleRss__Slider").addClass("unchecked"),$(".contentContainers").fadeOut().toggleClass("hidden flex").removeAttr("style"),$(".footer").toggleClass("fixed"))})),$(".settings__child__cancelBtn").click((()=>{s(),$(".backgroundImageUploadForm__InputFile, .chatCustomizationForm__inputFile").val(""),$(".contentContainers").hasClass("hidden")&&$(".contentContainers").fadeIn().toggleClass("hidden flex").removeAttr("style")})),$(".settings__child__saveBtn").click((()=>{$(".owmToken__input").val().match(/[a-z0-9]{32}/)&&(o.owmToken=owmToken=$(".owmToken__input").val()),$(".owmToken__input").val(o.owmToken),""!==$(".botNameCustomizationForm__input").val()&&$(".botNameCustomizationForm__input").val()!==$(".chatContainer__botInfo p").text()&&(o.bot={name:$(".botNameCustomizationForm__input").val()},$(".chatContainer__botInfo p").text(o.bot.name)),new Promise(((e,t)=>{if(""!==$(".backgroundImageUploadForm__InputFile").val()&&""===$(".backgroundImageUploadForm__InputUrl").val())$(".backgroundImageUploadForm__InputFile")[0].files[0].size/1048576>4.8?(a=!0,printError({type:"wallpaper upload",msg:"Your file is too laaaaarge ! Please select one under 5 Mb."}),t("Your file is too laaaaarge ! Please select one under 5 Mb.")):n(".backgroundImageUploadForm__InputFile","image/jpeg",(t=>{o.backgroundImage=t,e(t)}));else if(""===$(".backgroundImageUploadForm__InputFile").val()&&""===$(".backgroundImageUploadForm__InputUrl").val()){let t;e(t)}else""===$(".backgroundImageUploadForm__InputFile").val()&&""!==$(".backgroundImageUploadForm__InputUrl").val()?$(".backgroundImageUploadForm__InputUrl").val().match(/^(http|https):\/\/(www.|)[a-zA-Z0-9-\.\/]{1,}\.\w.+/i)?$(".backgroundImageUploadForm__InputUrl").val().length<200?(o.backgroundImage=$(".backgroundImageUploadForm__InputUrl").val(),e(o.backgroundImage)):(a=!0,printError({type:"wallpaper upload",msg:"Your URL is too large ! Please shorten it !"}),t("Your URL is too large ! Please shorten it !")):(a=!0,printError({type:"wallpaper upload",msg:"Your URL is not supported... Please try another one or open an issue on Github"}),t("Your URL is not supported... Please try another one or open an issue on Github")):""!==$(".backgroundImageUploadForm__InputFile").val()&&""!==$(".backgroundImageUploadForm__InputUrl").val()?(a=!0,printError({type:"wallpaper upload",msg:"Hey, don't be too powerful dude ! One field at a time !"}),t("Hey, don't be too powerful dude ! One field at a time !")):""===$(".backgroundImageUploadForm__InputFile").val()&&""===$(".backgroundImageUploadForm__InputUrl").val()&&""===$(".owmToken__input").val()&&($(".backgroundImage, header, .mainContainer").removeClass("blur"),$(".settings__container").fadeOut())})).then((e=>{void 0!==e&&($("head style").remove(),headStyle=`<style>.formContainer__container::before {background-image: url(${e});}</style>`,$("head").append(headStyle),$(".backgroundImage").css("backgroundImage",`url(${e})`))})).then((()=>{new Promise(((e,t)=>{if(""!==$(".chatCustomizationForm__inputFile").val()&&""===$(".chatCustomizationForm__inputUrl").val())$(".chatCustomizationForm__inputFile")[0].files[0].size/1048576>4.8?(a=!0,printError({type:"avatar upload",msg:"Your file is too laaaaarge ! Please select one under 5 Mb."}),t("Your file is too laaaaarge ! Please select one under 5 Mb.")):n(".chatCustomizationForm__inputFile","image/png",(t=>{o.bot={icon:t},$(".chatContainer__botInfo__icon").attr("src",t),e(t)}));else if(""===$(".chatCustomizationForm__inputFile").val()&&""===$(".chatCustomizationForm__inputUrl").val()){let t;e(t)}else""===$(".chatCustomizationForm__inputFile").val()&&""!==$(".chatCustomizationForm__inputUrl").val()?$(".chatCustomizationForm__inputUrl").val().match(/^(http|https):\/\/(www.|)[a-zA-Z0-9-\.\/]{1,}\.\w.+/i)?$(".chatCustomizationForm__inputUrl").val().length<250?(o.bot={icon:$(".chatCustomizationForm__inputUrl").val()},$(".chatContainer__botInfo__icon").attr("src",o.bot.icon),e(o.bot.icon)):(a=!0,printError({type:"avatar upload",msg:"Your URL is too large ! Please shorten it !"}),t("Your URL is too large ! Please shorten it !")):(a=!0,printError({type:"avatar upload",msg:"Your URL is not supported... Please try another one or open an issue on Github"}),t("Your URL is not supported... Please try another one or open an issue on Github")):""!==$(".chatCustomizationForm__inputFile").val()&&""!==$(".chatCustomizationForm__inputUrl").val()&&(a=!0,printError({type:"avatar upload",msg:"Hey, don't be too powerful dude ! One field at a time !"}),t("Hey, don't be too powerful dude ! One field at a time !"))})).then((e=>{a||(s(),socket.emit("customization",o),$(".backgroundImageUploadForm__InputFile").val(""),$(".uploadWarning").length&&$(".uploadWarning").remove(),void 0!==o.RSS&&(o.RSS?location.reload():$(".contentContainers").hide())),$(".backgroundImageUploadForm__InputFile, .chatCustomizationForm__inputFile").val(""),socket.on("customization data retrieved",(()=>{o={}}))})).catch((e=>console.error(e)))})).catch((e=>console.error(e)))})),$(".searchEngineSelection__select").on("change",(()=>{let e=$(".searchEngineSelection__select").val();o.searchEngine={},o.searchEngine.label=e,"Bing"===e?o.searchEngine.url=searchEngine.url="https://www.bing.com/search?q=":"DuckDuckGo"===e?o.searchEngine.url=searchEngine.url="https://duckduckgo.com/?q=":"Ecosia"===e?o.searchEngine.url=searchEngine.url="https://www.ecosia.org/search?q=":"Google"===e?o.searchEngine.url=searchEngine.url="https://www.google.com/search?q=test":"Qwant"===e&&(o.searchEngine.url=searchEngine.url="https://www.qwant.com/?q=")}))};let iPlaylist=0,mousePosition={},owmToken="",searchEngine={};const socket=io();let headStyle="",lastContent={},invidiousInstances=[];$.ajax({url:"./settings/settings.json",method:"GET",dataType:"json"}).done((e=>{void 0!==e.owmToken&&(owmToken=e.owmToken),void 0!==e.searchEngine?(searchEngine.label=e.searchEngine.label,searchEngine.url=e.searchEngine.url,$(".searchEngineSelection__select").val(e.searchEngine.label)):(searchEngine.label="DuckDuckGo",searchEngine.url="https://duckduckgo.com/?q=",$(".searchEngineSelection__select").val(searchEngine.label)),"BadassBot"!==e.bot.name&&$(".botNameCustomizationForm__input").val(e.bot.name),e.bot.icon.startsWith("http")&&$(".chatCustomizationForm__inputUrl").val(e.bot.icon)})),socket.on("wallpaper",(e=>{$.ajax({url:e,method:"GET",dataType:"",success:()=>{$("head style").remove(),headStyle=`<style>.formContainer__container::before {background-image: url(${e});}</style>`,$("head").append(headStyle),$(".backgroundImage").css("backgroundImage",`url(${e})`)}}).fail((e=>{200!==e.status&&(headStyle="<style>.formContainer__container::before {background-image: url('./client/scss/wallpaper.jpg');}</style>",$("head").append(headStyle),$(".msgContainer").text("Sorry, your background image couldn't be loaded... Maybe try another one"),fade(".msgContainer"),$(".backgroundImage").css("backgroundImage",""))}))})),$(".credits").hide(),socket.on("RSS status retrieved",(e=>{checkRSSstatus(e)})),showAbout(),showSettings(),showConverter(),parseContent(),socket.on("refresh app",(()=>{location.reload()})),socket.on("errorMsg",(e=>{printError(e)})),$(".questionBox").on("input",(()=>{autocomplete($(".questionBox").val())})),$(".form").keypress((e=>{13===e.keyCode&&(questionBoxSubmit(),$(".formContainer").css({padding:"0.5% 1%"}))})),$(".formSubmit").click((()=>{questionBoxSubmit()})),$(".msgContainer").text().match(/\w.+/)?fade(".msgContainer"):$(".msgContainer").hide(),$(window).mousemove((e=>{mousePosition.x=e.pageX,mousePosition.y=e.pageY})),$(".footer").mouseenter((()=>{$(".credits").fadeIn()})).mouseleave((()=>{$(".credits").fadeOut()})),socket.on("invidious instances",(e=>{invidiousInstances=e})),socket.on("playlist parsed",(e=>{$.ajax({url:"./tmp/playlist.json",dataType:"json",method:"GET"}).done((t=>{listen2Playlist(e,t)}))}));const addContentOptions=e=>{const t=(e,t,n)=>{if($(t).length){let n=$(`${t} .feedURL`).text();$(`${t} .updateContentBtn`).click((function(){if(t.match(/rss/i))socket.emit("update feed",{url:n,parent:e});else if(t.match(/forecast/i)){let t=$(".forecast__header__title").text().split(" ");t.splice(0,2),t=t[0],$.ajax({url:`https://api.openweathermap.org/data/2.5/find?q=${t}&units=metric&lang=en&appid=${owmToken}`,method:"POST",dataType:"json",statusCode:{401:()=>{printError({type:"weather",msg:"Sorry dude, your OpenWeatherMap token is invalid 😢. Please modify it in the settings.",element:e})},200:e=>{let t=e.list[0].weather[0].description.split(""),n=t[0].toUpperCase();t.shift(),t.unshift(n),t=t.join("");let s={temp:e.list[0].main.temp,city:e.list[0].name,description:t,humidity:e.list[0].main.humidity,windSpeed:e.list[0].wind.speed,weatherIcon:e.list[0].weather[0].icon};$(".forecast__content__info__description__desc").text(s.description),$(".forecast__content__info__temp__desc").text(`${s.temp} °C`),$(".forecast__content__info__wind__desc").text(`${s.windSpeed} km/h`),$(".forecast__content__info__humidity__desc").text(`${s.humidity} %`),updateWeatherIcon(s)}}})}}))}};$(e).ready((()=>{$(`${e} .article`).length&&t(`.${$(e).parents(".content__container").attr("id")} .${$(e).parents(".content").attr("id")}`,e),$(`${e} .forecast`).length&&t(e,`${e} .forecast`),$(`${e} .youtubeSearchContainer`).length&&((e,t,n)=>{$(t).length&&$(`${t} .contentOptions__clearResultsbtn`).click((function(){$(".youtubeSearchContainer__content__results").empty()}))})(0,`${e} .youtubeSearchContainer`)}))};socket.on("feed updated",(e=>{let t=e.feed;$(`${e.parent} .rssContainer`).remove(),buildRssContainer(t,e.parent,e.url,((t,n)=>{n.appendTo(e.parent),displayArticleSummary()}))}));const addWeatherContainer=(e,t)=>{$(`${t} .addContent:visible`).length&&$(`${t} .addContent`).hide();let n=e.list[0].id,s=e.list[0].weather[0].description.split(""),o=s[0].toUpperCase();s.shift(),s.unshift(o),s=s.join("");let a={temp:e.list[0].main.temp,city:e.list[0].name,description:s,humidity:e.list[0].main.humidity,windSpeed:e.list[0].wind.speed,weatherIcon:e.list[0].weather[0].icon};if(!$(`${t} .forecast`).length){let e=$("<section></section>").addClass("forecast flex").appendTo(t),s=$("<span></span>").addClass("forecast__header").appendTo(e),o=($("<a></a>").addClass("forecast__header__title").text(`Weather in ${a.city}`).attr("href",`https://openweathermap.org/city/${n}`).appendTo(s),$("<div></div>").addClass("forecast__content flex").appendTo(e)),i=$("<div></div>").addClass("forecast__content__info flex").appendTo(o),l=$("<span></span>").addClass("forecast__content__info__desc").appendTo(i),r=($("<p></p>").addClass("forecast__content__info__description__desc flex").text(a.description).appendTo(l),$("<span></span>").addClass("forecastIcon").text("🛈").prependTo(l),$("<span></span>").addClass("forecast__content__info__temp").appendTo(i)),d=($("<p></p>").addClass("forecast__content__info__temp__desc flex").text(`${a.temp} °C`).appendTo(r),$("<span></span>").addClass("forecastIcon").text("🌡").prependTo(r),$("<span></span>").addClass("forecast__content__info__wind").appendTo(i)),c=($("<p></p>").addClass("forecast__content__info__wind__desc").text(`${a.windSpeed} km/h`).appendTo(d),$("<img>").addClass("forecastIcon").attr({alt:"wind icon",src:"./client/scss/icons/interface/wind.svg"}).prependTo(d),$("<span></span>").addClass("forecast__content__info__humidity").appendTo(i)),p=($("<p></p>").addClass("forecast__content__info__humidity__desc flex").text(`${a.humidity} %`).appendTo(c),$("<span></span>").addClass("forecastIcon").text("💧").prependTo(c),$("<div></div>").addClass("forecast__weatherIcon flex").appendTo(o));$("<span></span>").addClass("forecast__weatherIcon__icon").appendTo(p);updateWeatherIcon(a);let u=$("<span></span>").addClass("contentOptions").appendTo(s);$("<img>").addClass("updateContentBtn").attr({alt:"Update content",src:"./client/scss/icons/interface/refresh.svg"}).appendTo(u),$("<img>").addClass("removeContentBtn").attr({alt:"Remove content",src:"./client/scss/icons/interface/cross.svg"}).appendTo(u);addContentOptions(t)}},autocomplete=e=>{let t=suggestions.filter((t=>{const n=new RegExp(`^${e}`,"gi");return t.label.match(n)}));if(e.length||(t=[],$(".suggestions").text("")),t!==[]&&e.length>=2&&e.startsWith("!")&&t.length>0){const e=t.map((e=>`\n            <div class="suggestion flex">\n              <img class="suggestion__icon" src="${e.icon}" alt="${e.desc} icon" height="20px" />\n              <span class="suggestion__label">${e.label}</span>\n              <span class="suggestion__desc">${e.desc}</span>\n            </div>\n            `)).join("");$(".suggestions").html(e),$(".suggestion").click((e=>{let t,n=e.target;"suggestion__label"===n.className?t=n.textContent:"suggestion__icon"===n.className?t=n.nextElementSibling.textContent:"suggestion__desc"===n.className?t=n.previousElementSibling.textContent:"suggestion"===n.className&&(t=n.children[1].textContent),t&&$(".questionBox").val(`${t} `).focus()}))}},buildRssContainer=(e,t,n,s)=>{let o=$("<section></section>"),a=$("<div></div>"),i=50,l=e.length%10;e.length<=i&&0===l||e.length<=10?i=e.length:e.length<=i&&l>0&&(i=e.length-l);let r=(i-1).toString().split(""),d=0;for(let l=0;l<i;l++)if(void 0!==e[l]&&l<=i-1){let c=$("<div></div>").addClass("article flex").appendTo(a);$("<a></a>").addClass("link").attr("href",e[l].link).append(`<span>${e[l].title}</span>`).appendTo(c),$("<div></div>").addClass("article__desc").append(e[l].summary).appendTo(a);if(i<10&&l===i-1||i>=10&&(l+1)%10==0&&l>0){if(a.addClass("linksContainer").appendTo(o),o.addClass(`rssContainer__${d+1}`),!o.children(".rssContainer__header").length){let s=$("<div></div>").addClass("rssContainer__header").prependTo(o),a=($("<a></a>").addClass("feedTitle").attr({href:e[0].meta.link}).text(e[0].meta.title).prependTo(s),$("<span></span>").addClass("contentOptions").appendTo(s));$("<img>").addClass("updateContentBtn").attr({alt:"Update content",src:"./client/scss/icons/interface/refresh.svg"}).appendTo(a);addRemovalBtn(a);$("<span></span>").addClass("feedURL hidden").append(n).appendTo(s);addContentOptions(`${t} .rssContainer__${d+1}`)}if(l>10?o.addClass("rssContainer hidden"):o.addClass("rssContainer flex"),i>10){let e,n=$('<svg class="rssContainer__arrows__left opacity0" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>'),s=$('<svg class="rssContainer__arrows__right flex" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>');e=r[1]>0?Number(r[0])+1:Number(r[0]);$("<span></span>").addClass("rssContainer__arrows flex").prepend(n).append(`<span>${d+1} / ${e}</span>`).append(s).appendTo(o);n.click((function(){let e=$(this).parents(".rssContainer").attr("class").split(" ")[0],n=Number(e.match(/\d{1,}/));n>1&&($(`${t} .${e}, ${t} .rssContainer__${n-1}`).toggleClass("hidden flex"),n-1==1?($(`${t} .rssContainer__${n-1} .rssContainer__arrows__right`).removeClass("opacity0").addClass("flex"),$(`${t} .rssContainer__${n-1} .rssContainer__arrows__left`).removeClass("flex").addClass("opacity0")):$(`${t} .rssContainer__${n-1} .rssContainer__arrows__right`).removeClass("opacity0").addClass("flex"))})),s.click((function(){let n=$(this).parents(".rssContainer").attr("class").split(" ")[0],s=Number(n.match(/\d{1,}/));s<e&&($(`${t} .${n}, ${t} .rssContainer__${s+1}`).toggleClass("hidden flex"),s+1===e?($(`${t} .rssContainer__${s+1} .rssContainer__arrows__right`).removeClass("flex").addClass("opacity0"),$(`${t} .rssContainer__${s+1} .rssContainer__arrows__left`).removeClass("opacity0").addClass("flex")):$(`${t} .rssContainer__${s+1} .rssContainer__arrows__left, ${t} .rssContainer__${s+1} .rssContainer__arrows__right`).removeClass("opacity0").addClass("flex"))}))}d++,s(e,o),o=$("<section></section>"),a=$("<div></div>")}}else d=0};let msgID=0,msgAuthor="";Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]},socket.on("username",(e=>{msgAuthor=e})),socket.on("bot avatar",(e=>{$.ajax({url:e,method:"GET",success:()=>{$(".chatContainer__botInfo__icon").attr("src",e)}}).fail((e=>{200!==e.status&&(()=>{$(".avatarMsg").length||$("<span></span>").addClass("msg reply avatarMsg").text("Sorry, my new avatar couldn't be loaded... Maybe try another one").appendTo(".chatContainer__msgList__list");$(".chatContainer__botInfo__icon").attr("src","./client/scss/icons/interface/bot.png")})()}))})),$(".chatContainer__msgList__form").submit((e=>{e.preventDefault(),(new Message).send()}));const copyText=e=>{let t=document.querySelector(e);t.select(),t.setSelectionRange(0,99999),document.execCommand("copy")},displayArticleSummary=()=>{$(".article").mouseenter((e=>{!$(".rssTooltip .article__desc").length&&e.currentTarget.className.match("article")&&($(e.currentTarget.nextElementSibling).clone().appendTo(".rssTooltip"),mousePosition.x<$(window).width()/100*30?$(".rssTooltip .article__desc").css({display:"inline-block",top:mousePosition.y-$(window).width()/100*5,left:mousePosition.x+$(window).width()/100*15}):$(".rssTooltip .article__desc").css({display:"inline-block",top:mousePosition.y-$(window).width()/100*5,left:mousePosition.x-$(window).width()/100*35}))})).mouseleave((e=>{$(".rssTooltip .article__desc").remove()}))},displaySvg=e=>{void 0!==e.videos[iPlaylist]&&(iPlaylist<e.videos.length?(0===iPlaylist&&$(".audio__leftSvg").hide(),$(".audio__rightSvg").click((()=>{iPlaylist++,iPlaylist<e.videos.length&&void 0!==e.videos[iPlaylist]&&($("#audioSrc").attr("src",`https://invidious.fdn.fr/latest_version?id=${e.videos[iPlaylist].videoId}&itag=251&local=true`),document.getElementById("audio__player").load(),$("#streamTitle").text(e.videos[iPlaylist].title),$("#YtId").text(` (Youtube ID : ${e.videos[iPlaylist].videoId})`),$(".playlistInfo").text(`${iPlaylist+1}/${e.videos.length}`),iPlaylist>0&&$(".audio__leftSvg").show(),iPlaylist===e.videos.length-1&&$(".audio__rightSvg").hide())})),$(".audio__leftSvg").click((()=>{iPlaylist>0&&(iPlaylist--,$("#audioSrc").attr("src",`https://invidious.fdn.fr/latest_version?id=${e.videos[iPlaylist].videoId}&itag=251&local=true`),document.getElementById("audio__player").load(),$("#streamTitle").text(e.videos[iPlaylist].title),$("#YtId").text(` (Youtube ID : ${e.videos[iPlaylist].videoId})`),$(".playlistInfo").text(`${iPlaylist+1}/${e.videos.length}`)),0===iPlaylist?$(".audio__leftSvg").hide():iPlaylist>0&&$(".audio__rightSvg").show()}))):$(".audio__rightSvg").show())},fade=e=>{$(e).fadeIn(2e3,(()=>{setTimeout((()=>{$(e).fadeOut(2e3)}),5e3)}))},handleOptionSelection=(e,t)=>{let n={},s=2;const o=n=>{void 0!==n?$(`${e} ${t} .addContent`).children().not(`${n}, ${n}__input, select, option, label, .addContent__btnContainer, .addContent__submitBtn, .addContent__cancelBtn`).hide():void 0===n&&($(`${e} ${t} .addContent__feed`).css("display","flex").addClass("hidden"),$(`${e} ${t} .addContent`).children().not(".addContent__feed, select, option, label, .addContent__btnContainer, .addContent__submitBtn, .addContent__cancelBtn").hide())},a=()=>{".content1__container"===e?(lastContent.content1++,s=lastContent.content1):".content2__container"===e?(lastContent.content2++,s=lastContent.content2):".content3__container"===e&&(lastContent.content3++,s=lastContent.content3),$(`${e} .newContent`).removeClass("newContent subRow flex").attr("id",`content${s}`).addClass(`content${s}`)};$(`${e} ${t} .addContent__select`).on("change",(()=>{$(`${e} ${t} .addContent__btnContainer`).css("display","inline-flex"),"Add a feed"===$(`${e} ${t} .addContent__select`).val()?($(`${e} ${t} .addContent`).removeClass("justifyCentered"),$(`${e} ${t} .addContent__select`).addClass("select"),$(`${e} ${t} .addContent__feed`).removeClass("hidden").addClass("flex").css("display",""),o(".addContent__feed"),$(`${e} ${t} .addContent__submitBtn`).click((()=>{let o=`${e} ${t}`;".newContent"===t?(a(),o=`${e} .content${s}`,n={element:`.content${s}`,parent:e,url:$(`${e} .content${s} .addContent__feed__input`).val(),type:"rss"}):n={element:t,parent:e,url:$(`${e} ${t} .addContent__feed__input`).val(),type:"rss"},null!==$(`${o} .addContent__feed__input`).val()&&void 0!==$(`${o} .addContent__feed__input`).val()&&$(`${o} .addContent__feed__input`).val().match(/^http/i)?(socket.emit("add content",n),$(`${o} .addContent`).hide()):printError({type:"rss",msg:"Hey, this value is invalid !",element:`${e} ${t} .addContent__feed`})}))):"Weather forecast"===$(`${e} ${t} .addContent__select`).val()?($(`${e} ${t} .addContent`).removeClass("justifyCentered"),$(`${e} ${t} .addContent__select`).addClass("select"),$(`${e} ${t} .addContent__weather`).css("display","").addClass("flex"),o(".addContent__weather"),$(`${e} ${t} .addContent__submitBtn`).click((function(){let s=`${e} ${t}`;".newContent"===t&&(a(),s=`${e} .${$(this).parents(".content").attr("id")}`);let o=`.${$(this).parents(".content").attr("id")}`;$.ajax({url:`https://api.openweathermap.org/data/2.5/find?q=${$(`${s} .addContent__weather__input`).val()}&units=metric&lang=en&appid=${owmToken}`,method:"POST",dataType:"json",statusCode:{400:()=>{printError({type:"weather",msg:"Something is wrong with your request... Please contact the dev to fix it.",element:`${e} ${o}`})},401:()=>{printError({type:"weather",msg:"Sorry dude, your OpenWeatherMap token is invalid 😢. Please modify it in the settings.",element:`${e} ${o}`})},200:s=>{n=".newContent"!==t?{element:t,parent:e,location:$(`${e} ${o} .addContent__weather__input`).val(),type:"weather"}:{element:o,parent:e,location:$(`${e} ${o} .addContent__weather__input`).val(),type:"weather"},0!==s.count?($(`${e} ${o} .addContent`).hide(),socket.emit("add content",n)):printError({type:"weather",msg:"Sorry homie, it seems this location doesn't exist...",element:`${e} ${t}`})}}})}))):"Youtube search box"===$(`${e} ${t} .addContent__select`).val()?($(`${e} ${t} .addContent`).removeClass("justifyCentered"),$(`${e} ${t} .addContent__select`).addClass("select"),$(`${e} ${t} .addContent__youtube`).css("display","").addClass("flex"),o(".addContent__youtube"),$(`${e} ${t} .addContent__submitBtn`).click((function(){".newContent"===t&&(a(),addContentParentClass=`${e} .${$(this).parents(".content").attr("id")}`);let n=`.${$(this).parents(".content").attr("id")}`;".newContent"!==t?socket.emit("add content",{element:t,parent:e,type:"youtube search"}):socket.emit("add content",{element:n,parent:e,type:"youtube search"}),$(`${e} ${n} .addContent`).hide()}))):($(`${e} ${t} .addContent`).addClass("justifyCentered"),$(`${e} ${t} .addContent__select`).removeClass("select"),$(`${e} ${t} .addContent`).children().not("select, option, label").hide())})),$(`${e} ${t} .addContent__cancelBtn`).click((function(){$(this).parents(".addContent").fadeOut(),$(`${e} ${t} .blank`).css("display","")}))},listen2Playlist=(e,t)=>{if(void 0===t.videos[iPlaylist])printError({type:"generic",msg:"Invalid playlist reference !"});else if(iPlaylist<t.videos.length&&!t.videos[iPlaylist].title.match(/deleted video/gi)&&void 0!==t.videos[iPlaylist]){if(hideContent(".audio__remove"),$(".audio").addClass("playlist flex"),$(".audio__leftSvg, .audio__rightSvg").off(),$(".contentContainers").css("marginTop",0),$(".audio__player").length){if($("#audioSrc").attr("src",`${e}/latest_version?id=${t.videos[iPlaylist].videoId}&itag=251&local=true`),!$(".audio__leftSvg").length){$('<svg class="audio__leftSvg" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>').hide().prependTo(".audio"),$('<svg class="audio__rightSvg" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>').hide().appendTo(".audio")}$(".streamInfoContainer, .audio__container__player, .playlistInfo, .audio__leftSvg, .audio__rightSvg").show(),$(".playlistEndMsg").hide()}else{$("<audio></audio>").attr({id:"audio__player",controls:"controls",autoplay:"autoplay"}).addClass("audio__player").text("Your browser does not support the audio element :(").appendTo(".audio__container__player"),$('<svg class="audio__leftSvg" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>').prependTo(".audio"),$('<svg class="audio__rightSvg" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>').appendTo(".audio"),$("<source>").attr({id:"audioSrc",src:`${e}/latest_version?id=${t.videos[iPlaylist].videoId}&itag=251&local=true`,type:" audio/mpeg"}).appendTo(".audio__player")}if($(".streamInfoContainer").length)if($("#streamTitle").text(t.videos[iPlaylist].title),$("#YtId").text(`(Youtube ID : ${t.videos[iPlaylist].videoId})`),$(".playlistInfo").length)$(".playlistInfo").show().text(`${iPlaylist+1}/${t.videos.length}`);else{$("<span></span>").addClass("playlistInfo").text(`${iPlaylist+1}/${t.videos.length}`).show().prependTo(".audio__container__msg")}else{$("<span></span>").addClass("playlistInfo").text(`${iPlaylist+1}/${t.videos.length}`).show().prependTo(".audio__container__msg"),$("<span></span>").addClass("streamInfoContainer").appendTo(".audio__container__msg"),$("<p></p>").attr("id","streamTitle").addClass("streamTitle").text(t.videos[iPlaylist].title).appendTo(".streamInfoContainer"),$("<p></p>").text(` (Youtube ID : ${t.videos[iPlaylist].videoId})`).attr("id","YtId").addClass("YtId").appendTo(".streamInfoContainer")}document.getElementById("audio__player").load(),document.getElementById("audio__player").onended=()=>{if(iPlaylist++,void 0!==t.videos[iPlaylist])listen2Playlist(e,t);else{if($(".audio__leftSvg, .audio__remove").hide(),$(".audio__container__player, .streamInfoContainer, .playlistInfo").hide(),!$(".endOfPlaylist").length){$("<span></span>").text("There is no track left in here... 😭").addClass("audio__container__msg__playlistEnd").prependTo(".audio__container__msg");$(".audio").removeClass("playlist")}$(".audio").css("width","50%"),$(".audio__container__msg").css({justifyContent:"center",width:"100%"}),fade($(".audio"))}},$(".audio__player").show(),$(".audio__container__msg").show(),$(".audio").fadeIn(1500,(()=>{$(".audio").css("display","flex")})),displaySvg(t)}else void 0===t.videos[iPlaylist]?printError({type:"generic",msg:"Video ID not found !"}):t.videos[iPlaylist].title.match(/(deleted video) || (private video)/gi)&&(iPlaylist++,listen2Playlist(e,t))};$(".menu__item").click((()=>{$(".header__menu__switch").prop("checked")&&$(".header__menu__switch").prop("checked",!1)}));const Message=function(){this.author=msgAuthor,this.content=$(".chatContainer__msgList__form__inputMsg").val(),this.id=msgID,this.dateTime=new Date,this.send=function(){return new Promise(((e,t)=>{if(null!==this.content&&""!==this.content){$("<span></span>").addClass("msg flex").text(this.content).appendTo(".chatContainer__msgList__list");socket.emit("chat msg",this),$(".chatContainer__msgList__form__inputMsg").val(""),msgID++,e(this)}else t(this)}))}},openUrl=e=>{let t=e.split(" ");for(let e=0;e<suggestions.length;e++)if(t[0]===suggestions[e].label){t.shift();let n=t.join(" ");void 0!==suggestions[e].url&&null!==suggestions[e]&&("!iv"===suggestions[e].label?window.open(`${suggestions[e].url}${n}&local=true`):"!mmnl"===suggestions[e].label?window.open(`${suggestions[e].url}${n}&searchProfile=onlineshop&channel=mmnlnl`):"!pb"===suggestions[e].label?window.open(`${suggestions[e].url}${n}/-/`):"!1337x"===suggestions[e].label?window.open(`${suggestions[e].url}${n}/1/`):window.open(`${suggestions[e].url}${n}`))}$(".questionBox").val(""),$(".formContainer").css({borderRadius:"2em"}),$(".suggestion").hide()},printError=e=>{if("generic"===e.type)$(".msgContainer").addClass("warning").text(e.msg).show(),setTimeout((()=>{$(".msgContainer").hide().removeClass("warning")}),5e3);else if("weather"===e.type){if(null!==e.element&&void 0!==e.element&&($(e.element).off(),!$(`${e.element} .warning`).length)){$("<span></span>").addClass("warning").text(e.msg).appendTo(`${e.element} .addContent__weather`)}}else if("rss"===e.type){$("<span></span>").addClass("warning").text(e.msg).appendTo(e.element)}else if("rss verification"===e.type){if($(e.element).off(),!$(`${e.element} .rssWarning`).length){$(`${e.element} .addContent, ${e.element} .addContent__feed`).css("display","").addClass("flex");$("<span></span>").addClass("warning rssWarning").text(e.msg).appendTo($(`${e.element} .addContent__feed`))}}else if("unit conversion"===e.type)if($(".converter .warning").length)$(".converter .waring").css("display","flex");else{$("<b></b>").text(e.msg).addClass("warning").appendTo(e.element)}else if("wallpaper upload"===e.type){if(!$(".settings__container .uploadWarning").length){let t=$("<b></b>").text(e.msg).addClass("warning uploadWarning").css("display","");$(".backgroundImageUploadForm").after(t)}}else if("avatar upload"===e.type&&!$(".settings__container .uploadWarning").length){let t=$("<b></b>").text(e.msg).addClass("warning uploadWarning").css("display","");$(".chatCustomizationForm").after(t)}},processInput=e=>{let t=e.split(" ");const n=(e,t,s,o,a)=>{e<o.length&&$.ajax({url:`${o[e]}${t}${a}`,method:"GET",dataType:"json"}).done((i=>{if(0!==i.length&&e<o.length){let n=`${o[e]}${t}${a}`;return socket.emit("parse playlist",{url:n,playlist:i}),void(e=0)}e++,n(e,t,s,o[e],a)})).fail((i=>{e<o.length?(e++,n(e,t,s,o[e],a)):(printError({type:"generic",msg:"Sorry, the audio stream failed to load due to a server error... Try maybe later."}),e=0)}))};if(e.startsWith("!")){if(openUrl(e),e.startsWith("!d ")){if(e.match(/[0-9A-Za-z_-]{11}/)){let t=e.match(/[0-9A-Za-z_-]{11}/)[0];socket.emit("download",t),socket.emit("audio info request",t),socket.on("audio info retrieved",(e=>{if(void 0!==e.title&&null!==e.title){let t=`Your download for ${e.title} started !`;$(".msgContainer").text(t),$(".msgContainer").show()}})),socket.on("download ended",(e=>{$(".msgContainer").text(`Your download for ${e.title} ended !`),setTimeout((()=>{$(".msgContainer").fadeOut(1500)}),2e3),window.open(`${window.location.href}download`)}))}else printError({type:"generic",msg:"You pasted an invalid link. If you tried to paste a URL, try the video ID only"})}if(e.startsWith("!p "))if(e.match(/[0-9A-Za-z_-]{11}/)&&!e.match(/[0-9A-Za-z_-]{13,34}/)){let t=e.match(/[0-9A-Za-z_-]{11}/)[0];const n=(e,n)=>{let s=e.title,o=(()=>{for(const[s,o]of e.adaptiveFormats.entries()){if(o.type.match(/audio/))return`${n}/latest_version?id=${t}&itag=251&local=true`;s===e.adaptiveFormats.length-1&&printError({type:"generic",msg:"Sorry, this stream couldn't be played. Please try another video."})}})();if($(".audio__player").length)$("#audioSrc").attr("src",o);else{$("<audio></audio>").attr({id:"audio__player",controls:"controls",autoplay:"autoplay"}).addClass("audio__player").text("Your browser does not support the audio element.").appendTo(".audio__container__player"),$("<source>").attr({id:"audioSrc",src:o,type:"audio/mpeg"}).appendTo(".audio__player")}if(!$(".streamInfoContainer").length){let e=$("<span></span>").addClass("streamInfoContainer").appendTo(".audio__container__msg");$("<p></p>").attr("id","streamTitle").addClass("streamTitle").appendTo(e),$("<p></p>").attr("id","YtId").addClass("YtId").appendTo(e)}document.getElementById("audio__player").load(),($(".audio__leftSvg").length||$(".audio__rightSvg").length)&&$(".audio__leftSvg, .audio__rightSvg, .playlistInfo").hide(),$("#streamTitle").text(s),$("#YtId").text(`(Youtube ID : ${t})`),$(".streamInfoContainer").css({textAlign:"center",width:"100%"}),$(".audio__container__msg, .streamInfoContainer, .audio__player").show(),$(".audio").fadeIn(1500,(()=>{$(".audio").css("display","flex")})),document.getElementById("audio__player").onended=()=>{$(".audio").fadeOut(1500)},hideContent(".audio__remove")};const s=(e,o)=>{$.ajax({url:`${o}/api/v1/videos/${t}`,method:"GET",dataType:"json"}).done((t=>{if(0!==t.length)return n(t,invidiousInstances[e]),void(e=0);0===t.length&&e<invidiousInstances.length?s(e,invidiousInstances[e+1]):(printError({type:"generic",msg:"Sorry, the audio stream failed to load due to a server error... Try maybe later."}),e=0)})).fail((t=>{e<invidiousInstances.length?s(e,invidiousInstances[e+1]):(printError({type:"generic",msg:"Sorry, the audio stream failed to load due to a server error... Try maybe later."}),e=0)}))};s(0,invidiousInstances)}else if(e.match(/[a-zA-Z0-9-_]{15,34}/)){iPlaylist=0;let t=e.match(/[a-zA-Z0-9-_]{15,34}/)[0];n(0,"/api/v1/playlists/","playlists",invidiousInstances,t)}else if(e.match(/[0-9A-Za-z_-]{13}/)&&!e.match(/[0-9A-Za-z_-]{14,34}/)){iPlaylist=0;let t=e.match(/[0-9A-Za-z_-]{13}/);n(iPlaylist,"/api/v1/mixes/","mixes",invidiousInstances,t)}else printError({type:"generic",msg:"Bad URL :(("})}else if(null!=e&&""!==e){let e=t.join(" ");window.open(`${searchEngine.url}${e}`),$(".questionBox").val("")}},questionBoxSubmit=()=>{""!==$(".questionBox").val()&&$(".form").submit((e=>{iPlaylist=0;let t=$(".questionBox").val();e.preventDefault(),processInput(t)}))};socket.on("reply",(e=>{e.add=function(){setTimeout((()=>{$("<span></span>").addClass("msg reply").append(e.content).appendTo(".chatContainer__msgList__list")}),500)},e.addEmbed=function(){let t=$("<span></span>").addClass("msg reply embed");if(void 0!==e.content.title){let n=$("<div></div>").addClass("embed__fields");if(t.css("border-left",`0.5em solid ${e.content.color}`).append(`<img src="${e.content.icon}" alt="${e.content.title} icon" class="embed__icon"/>`).append(`<a href="${e.content.url}" class="embed__title">${e.content.title}</a>`),void 0!==e.content.fields)for(const[s,o]of e.content.fields.entries()){$("<div></div>").addClass("embed__field").append(o).appendTo(n);s===e.content.fields.length-1&&t.append(n)}t.append(`<article class="embed__desc">${e.content.description}</article>`),void 0!==e.content.img&&t.append(`<img src="${e.content.img}" alt="${e.content.title} picture" class="embed__pic"/>`)}else t.append(`<span>${e.content}</span>`);t.appendTo(".chatContainer__msgList__list")},"wiki"!==e.theme&&"movie review"!==e.theme?e.add():e.addEmbed()}));const restoreScroll=()=>{$("html, body").css({overflow:"",height:""})},disableScroll=()=>{$("html, body").css({overflow:"hidden",height:"100%"})},suggestions=[{label:"!1337x",desc:"1337x.am",icon:"./client/scss/icons/suggestions/1337x.ico",url:"https://www.1337x.am/search/"},{label:"!afr",desc:"Amazon (FR)",icon:"./client/scss/icons/suggestions/amazon.png",url:"https://www.amazon.fr/s?k="},{label:"!a",desc:"Amazon (US)",icon:"./client/scss/icons/suggestions/amazon.png",url:"https://www.amazon.com/s?k="},{label:"!alto",desc:"AlternativeTo",icon:"./client/scss/icons/suggestions/alto.ico",url:"https://alternativeto.net/browse/search?q="},{label:"!css",desc:"CSS Tricks",icon:"./client/scss/icons/suggestions/csstricks.png",url:"https://css-tricks.com/?s="},{label:"!d",desc:"Download a YouTube audio stream",icon:"./client/scss/icons/suggestions/download.png"},{label:"!fdroid",desc:"F-Droid",icon:"./client/scss/icons/suggestions/fdroid.png",url:"https://search.f-droid.org/?q="},{label:"!g",desc:"Google",icon:"./client/scss/icons/suggestions/google.png",url:"https://www.google.com/search?q="},{label:"!gh",desc:"Github",icon:"./client/scss/icons/suggestions/github.ico",url:"https://github.com/search?q="},{label:"!gt",desc:"Google translate",icon:"./client/scss/icons/suggestions/gt.ico",url:"https://translate.google.com/#view=home&op=translate&sl=auto&tl=en&text="},{label:"!gmap",desc:"Google Maps",icon:"./client/scss/icons/suggestions/maps.ico",url:"https://www.google.be/maps/search/"},{label:"!htg",desc:"How-to Geek",icon:"./client/scss/icons/suggestions/howtogeek.ico",url:"https://www.howtogeek.com/search/?q="},{label:"!iv",desc:"invidious.fdn.fr",icon:"./client/scss/icons/suggestions/invidious.png",url:"https://invidious.fdn.fr/search?q="},{label:"!jq",desc:"Jquery API",icon:"./client/scss/icons/suggestions/jquery.ico",url:"https://api.jquery.com/?ns0=1&s="},{label:"!k",desc:"korben.info",icon:"./client/scss/icons/suggestions/korben.png",url:"https://korben.info/search/"},{label:"!ldlc",desc:"LDLC",icon:"./client/scss/icons/suggestions/ldlc.png",url:"https://www.ldlc.com/fr-be/recherche/"},{label:"!lg",desc:"Les Grignoux",icon:"./client/scss/icons/suggestions/grignoux.png",url:"https://www.grignoux.be//fr/recherche?search="},{label:"!li",desc:"LinkedIn",icon:"./client/scss/icons/suggestions/linkedin.ico",url:"https://www.linkedin.com/search/results/all/?keywords="},{label:"!ln",desc:"Les Numériques",icon:"./client/scss/icons/suggestions/ln.png",url:"https://www.lesnumeriques.com/recherche?q="},{label:"!mdn",desc:"Mozilla Developer network",icon:"./client/scss/icons/suggestions/mdn.png",url:"https://developer.mozilla.org/en-US/search?q="},{label:"!mmfr",desc:"Media Markt (BE FR)",icon:"./client/scss/icons/suggestions/mm.png",url:"https://www.mediamarkt.be/fr/search.html?query="},{label:"!mmnl",desc:"Media Markt (BE NL)",icon:"./client/scss/icons/suggestions/mm.png",url:"https://www.mediamarkt.nl/nl/search.html?query="},{label:"!mt",desc:"Marine Traffic",icon:"./client/scss/icons/suggestions/marinetraffic.ico",url:"https://www.marinetraffic.com/en/ais/index/search/all?keyword="},{label:"!pb",desc:"Pages Blanches (BE)",icon:"./client/scss/icons/suggestions/pagesblanches.ico",url:"https://www.pagesblanches.be/chercher/personne/"},{label:"!os",desc:"OpenSubtitles",icon:"./client/scss/icons/suggestions/opensub.ico",url:"https://www.opensubtitles.org/en/search2/sublanguageid-all/moviename-"},{label:"!osm",desc:"OpenStreetMap",icon:"./client/scss/icons/suggestions/osm.png",url:"https://www.openstreetmap.org/search?query="},{label:"!owm",desc:"OpenWeatherMap",icon:"./client/scss/icons/suggestions/owm.ico",url:"https://openweathermap.org/find?q="},{label:"!p",desc:"Play a Youtube audio stream or playlist",icon:"./client/scss/icons/suggestions/play.svg"},{label:"!r",desc:"Reddit",icon:"./client/scss/icons/suggestions/reddit.webp",url:"https://www.reddit.com/search?q="},{label:"!rarbg",desc:"RARBG",icon:"./client/scss/icons/suggestions/rarbg.png",url:"http://rarbgmirror.org/torrents.php?search="},{label:"!rt",desc:"Rottentomatoes",icon:"./client/scss/icons/suggestions/rottentomatoes.png",url:"https://www.rottentomatoes.com/search/?search="},{label:"!rtbf",desc:"RTBF",icon:"./client/scss/icons/suggestions/rtbf.png",url:"https://www.rtbf.be/info/recherche?q="},{label:"!sc",desc:"SoundCloud",icon:"./client/scss/icons/suggestions/soundcloud.ico",url:"https://soundcloud.com/search?q="},{label:"!so",desc:"Stack Overflow",icon:"./client/scss/icons/suggestions/so.ico",url:"https://stackoverflow.com/search?q="},{label:"!torrent",desc:"Oxtorrent.com",icon:"./client/scss/icons/suggestions/torrent.ico",url:"https://www.oxtorrent.com/recherche/"},{label:"!uc",desc:"Unicode table",icon:"./client/scss/icons/suggestions/unicode.ico",url:"https://unicode-table.com/en/search/?q="},{label:"!w",desc:"Wikipedia (EN)",icon:"./client/scss/icons/suggestions/wikipedia.ico",url:"https://en.wikipedia.org/w/index.php?search="},{label:"!wfr",desc:"Wikipedia (FR)",icon:"./client/scss/icons/suggestions/wikipedia.ico",url:"https://fr.wikipedia.org/w/index.php?search="},{label:"!wt",desc:"Wikitionnary (EN)",icon:"./client/scss/icons/suggestions/wt.ico",url:"https://en.wiktionary.org/w/index.php?search="},{label:"!wtfr",desc:"Wikitionnary (FR)",icon:"./client/scss/icons/suggestions/wt.ico",url:"https://fr.wiktionary.org/w/index.php?search="},{label:"!yarn",desc:"Yarn",icon:"./client/scss/icons/suggestions/yarn.ico",url:"https://yarnpkg.com/en/packages?q="},{label:"!yt",desc:"Youtube",icon:"./client/scss/icons/suggestions/yt.ico",url:"https://www.youtube.com/results?search_query="},{label:"!bbc",desc:"BBC News",icon:"./client/scss/icons/suggestions/bbc.png",url:"https://www.bbc.co.uk/search?q="}],updateWeatherIcon=e=>{if(e.description.match(/clear sky/i))$(".forecast__weatherIcon__icon").text("☼").css({color:"yellow"});else if(e.description.match(/clouds/i))$(".forecast__weatherIcon__icon").text("☁");else if(e.description.match(/rain/i))$(".forecast__weatherIcon__icon").text("🌧");else if(e.description.match(/mist/i)){$(".forecast__weatherIcon__icon").addClass("icon flex");let e=$("<img>").attr({src:"./client/scss/icons/interface/mist.svg",alt:"Mist icon"});$(".forecast__weatherIcon__icon img").length?$(".forecast__weatherIcon__icon img").replaceWith(e):e.appendTo($(".forecast__weatherIcon__icon"))}},youtube2rss=()=>{$(".yt2rssLink").click((()=>{$(".yt2rss").addClass("flex").removeClass("hidden"),disableScroll(),$(".mainContainer, header, .backgroundImage").addClass("blur"),$(".yt2rss__container__child__left__input").on("input",(function(){if($(this).val().match(/[A-Za-z0-9-]{24}/)){let e=`https://www.youtube.com/feeds/videos.xml?channel_id=${$(this).val()}`;$(".yt2rss__container__child__left__output").val(e)}})),$(".yt2rss").click((function(e){e.target===this&&($(this).addClass("hidden").removeClass("flex"),$(".mainContainer, .header, .backgroundImage").removeClass("blur"),restoreScroll())})),$(".yt2rss__container__child__right__svgBtn").click((()=>{copyText(".yt2rss__container__child__left__output")}))}))};youtube2rss();
